<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.7.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.7.0/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.7.0/firebase-database.js"></script>
    <script defer src="/__/firebase/7.7.0/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.7.0/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <!DOCTYPE html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Google Play Scraper</title>
        <meta name="description" content="Scrapes play.google website for user reviews">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="./gplay.png" />
    
        <link rel="stylesheet" href="paper.css">
        <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    
        <!-- Bootstrap 4 -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
            integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
        <!-- Bootstrap 4 -->
    
    </head>
    
    <body>
        <div class="container">
            <h1>Googe Play Scraper GUI</h1>
    
            <hr>
    
            <div class="row">
                <div class="col-md-4">
                    <ul id="app_list_group" class="list-group">
    
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            com.whatsapp
                            <span class="badge badge-pill badge-primary">30000</span>
                        </li>
    
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            com.instagram
                            <span class="badge badge-pill badge-primary">90000</span>
                        </li>
    
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            com.pinterest
                            <span class="badge badge-pill badge-primary">60000</span>
                        </li>
    
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            com.waze
                            <span class="badge badge-pill badge-primary">10000</span>
                        </li>
                    </ul>
    
                    <br>
    
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">App ID</span>
                        </div>
                        <input id="app_name_input" type="text" class="form-control" placeholder="com.whatsapp"
                            aria-label="Application identifier">
                    </div>
    
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Reviews</span>
                        </div>
                        <input id="review_count_input" type="text" class="form-control" placeholder="5000">
                    </div>
    
                    <button class="btn btn-outline-secondary" id="add_app_btn" onclick="appendApp()" type="button"><span
                            class="fa fa-plus"></span></button>
    
                    <button class="btn btn-outline-secondary" id="remove_app_btn" onclick="showRemoveButtons()"
                        type="button"><span class="fa fa-trash-o"></span></button>
    
                </div>
    
                <div class="col-md-8">
                    <p>
                        Visit the <a href="https://play.google.com/store/apps"><i>Google Play Store</i></a> and collect the
                        identifiers for the apps you
                        want to scrape. Append them to the list below together with the amount of reviews you want to scrape
                        per application.
                        <br><br>
                        To start the scrape, click and hold the start button for three seconds.
                        <br><br>
    
                        <div class="progress">
                            <div class="progress-bar" role="progressbar" style="width: 25%;"
                            aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                        </div>
                    </p>
                </div>
            </div>
    
        </div>
    
    
        <script src="./js/scraper_v211.js" async defer></script>
        </script>
    </body>
    
    </html>
    
    <script type="text/javascript">
        (function () {
            window.addEventListener && window.addEventListener("load", fn) ||
                window.attachEvent && window.attachEvent("load", fn);
        })();
    
        function redirect(url) {
            console.log("redirecting...");
            window.location.href = "https://play.google.com/store/apps/details?id=com.pinterest&showAllReviews=true";
        };
    
        function fn() {
            console.log(getApps());
        }
    
        function appendApp() {
            var app_name = document.getElementById("app_name_input").value;
            var review_count = document.getElementById("review_count_input").value;
    
            if (app_name.length < 1 || review_count.length < 1) {
                alert("Parameters cannot be empty.");
                return;
            } else {
                var list_group = document.getElementById("app_list_group");
    
                var li = document.createElement("li");
                li.className = "list-group-item d-flex justify-content-between align-items-center";
                li.innerText = app_name;
    
                var count = document.createElement("span");
                count.className = "badge badge-pill";
                count.innerText = review_count;
    
                li.appendChild(count);
                list_group.appendChild(li);
            }
            setApps(list_group.children);
        }
    
        function showRemoveButtons() {
            var list_group = document.getElementById("app_list_group");
            var remove_app_btn = document.getElementById("remove_app_btn");
    
            if (remove_app_btn.className.includes("remove_active")) {
                remove_app_btn.classList.remove("remove_active");
    
                var remove_buttons = document.getElementsByClassName("del_btn");
                while (remove_buttons.length > 0) {
                    remove_buttons[0].parentElement.removeChild(remove_buttons[0]);
                }
                return;
            } else {
                remove_app_btn.classList.add("remove_active");
    
                for (var i = 0; i < list_group.children.length; i++) {
                    var btn = document.createElement("button");
                    btn.className = "btn btn-outline-secondary del_btn";
                    btn.onclick = deleteApp;
                    btn.innerHTML = "<span class='fa fa-times-circle-o'></span>";
                    list_group.children[i].appendChild(btn);
                }
            }
        }
    
        function deleteApp(element) {
            var list_group = document.getElementById("app_list_group");
            list_group.removeChild(this.parentElement);
            setApps(list_group.children);
        }
    
        function setApps(list) {
            var apps = [];
            for (var i = 0; i < list.length; i++) {
                var arr = list[i].innerText.split("\n");
                var app_id = arr[0];
                var count = arr[1];
                apps.push([app_id, count]);
            }
            setCookie("gplay_app_list", JSON.stringify(apps), 10);
        }
    
        function getApps() {
            const cname = "gplay_app_list";
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }
    
        function setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires="+d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=C:\\Users\\Gøran\\Documents\\Projects\\Google Play Scraper\\gplay_scrape";
        }
    
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        //
        // // 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥

        try {
          let app = firebase.app();
          let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
      });
    </script>
  </body>
</html>
